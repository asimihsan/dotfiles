- defaults:
    link:
      relink: true

- clean: ["~"]

- create:
    - ~/.config

- link:
    ~/config: config
    # ~/.doom.d: doom.d
    ~/.hammerspoon:
      if: "[ `uname` = Darwin ]"
      path: hammerspoon
    # ~/.spacemacs: spacemacs

    # TODO FIXME
    # ~/.ssh/config: sshconfig

- shell:
    - command: sudo -v
      stdin: true
      description: Caching sudo credentials
    - command: while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &
      description: Keeping sudo alive
    - command: sudo mkdir -p /usr/local/etc
      stdin: true
      stdout: true
      description: Creating /usr/local/etc
    - command: sudo mkdir -p /var/run/chrony
      stdin: true
      stdout: true
      description: Creating /var/run/chrony
    - command: sudo ln -sf "${PWD}/chrony.conf" /usr/local/etc/chrony.conf
      stdin: true
      stdout: true
      description: Linking chrony.conf to /usr/local/etc/chrony.conf
    - command: sudo ln -sf "${PWD}/chrony.plist" /Library/LaunchDaemons/com.chrony.chronyd.plist
      stdin: true
      stdout: true
      description: Linking chrony.plist to /Library/LaunchDaemons/com.chrony.chronyd.plist
    - command: sudo chown root:wheel /Library/LaunchDaemons/com.chrony.chronyd.plist
      stdin: true
      stdout: true
      description: Changing owner of /Library/LaunchDaemons/com.chrony.chronyd.plist to root:wheel
    - command: sudo chmod 644 /Library/LaunchDaemons/com.chrony.chronyd.plist
      stdin: true
      stdout: true
      description: Changing permissions of /Library/LaunchDaemons/com.chrony.chronyd.plist to 644
    - command: sudo launchctl load /Library/LaunchDaemons/com.chrony.chronyd.plist
      stdin: true
      stdout: true
      description: Loading chronyd service

- create:
    - ~/bin
    - ~/workplace
    - ~/logs

- link:
    ~/bin/backup-docker-images: backup-docker-images
    ~/bin/bib2filename.py: bib2filename.py
    ~/bin/curltime: curltime
    ~/bin/download-youtube: download-youtube
    # ~/bin/emacs-setup: emacs-setup
    # ~/bin/e: e
    ~/bin/merge-zsh-history: merge-zsh-history
    ~/bin/mount.sh: mount.sh
    ~/bin/pikchr: pikchr
    ~/bin/sync-to-dropbox: sync-to-dropbox
    ~/bin/tag-cache-dirs: tag-cache-dirs
